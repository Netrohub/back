# ๐ง ุฅุตูุงุญ ูุดููุฉ ุงูุฃุณูุงุก ุงููุญุฌูุฒุฉ

## ๐ ุงููุดููุฉ

ุงูุชุทุจูู ูุญุงูู ุงูุชุญูู ูู ุฌุฏูู `reserved_usernames` ุงูุฐู ูุง ููุฌุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ููุง ูุณุจุจ ูุดู ุงูุชุณุฌูู ุจุงูุฎุทุฃ:

```
The table `reserved_usernames` does not exist in the current database.
```

---

## โ ุงูุญู ุงููุทุจูู

### 1. **ุฅุตูุงุญ ุงูููุฏ (ุชู ุชุทุจููู) โ**

ุชู ุชุญุฏูุซ `src/auth/auth.service.ts` ููุชุนุงูู ูุน ุงูุฌุฏูู ุงูููููุฏ ุจุดูู ุตุญูุญ:

```typescript
try {
  // ูุญุต ุงูุฃุณูุงุก ุงููุญุฌูุฒุฉ
  const reservedUsername = await this.prisma.$queryRaw`...`;
  // ...
} catch (error) {
  // ุฅุฐุง ูุงู ุงูุงุณู ูุญุฌูุฒุงู ูุนูุงูุ ุฃุนุฏ ุฑูู ุงูุฎุทุฃ
  if (error instanceof ConflictException) {
    throw error;
  }
  // ุฅุฐุง ูุงู ุงูุฌุฏูู ุบูุฑ ููุฌูุฏุ ุชุฌุงูุฒ ุงููุญุต ูุงุณุชูุฑ
}
```

**ุงูุชุบููุฑุงุช:**
- โ ููุชูุท ุฃุฎุทุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุฌุฏูู ุบูุฑ ููุฌูุฏ) ุจุดูู ุตุญูุญ
- โ ูุง ูุฒุงู ูุฑูุถ ุงูุฃุณูุงุก ุงููุญุฌูุฒุฉ ูุนููุงู
- โ ูุณูุญ ุจุงูุชุณุฌูู ุฅุฐุง ูู ููู ุงูุฌุฏูู ููุฌูุฏุงู
- โ ูุณุฌูู ุงูุฃุฎุทุงุก ููุท ูู ุจูุฆุฉ ุงูุชุทููุฑ

---

## ๐ ูุดุฑ ุงูุฅุตูุงุญ

### ุงูุฎูุงุฑ 1: ูุดุฑ ุณุฑูุน (ุฅุตูุงุญ ุงูููุฏ ููุท)

ุชู ุชุทุจูู ุฅุตูุงุญ ุงูููุฏ. ููุท ุงูุดุฑ ุงูููุฏ ุงููุญุฏูุซ:

```bash
git add .
git commit -m "fix: handle missing reserved_usernames table gracefully"
git push
```

**Render ุณูููู ุจุงููุดุฑ ุงูุชููุงุฆู.**

### ุงูุฎูุงุฑ 2: ุฅุถุงูุฉ ุฌุฏูู ุงูุฃุณูุงุก ุงููุญุฌูุฒุฉ (ุงุฎุชูุงุฑู)

ุฅุฐุง ุฃุฑุฏุช ููุน ุงุณุชุฎุฏุงู ุฃุณูุงุก ูุนููุฉ ูุนููุงู:

#### ุนูู VPS ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```bash
# ุชูููุฐ ุงูู migration
psql $DATABASE_URL < migrations/003_add_reserved_usernames.sql
```

**ุฃู ูู phpMyAdmin/pgAdmin:**
- ุงูุชุญ `migrations/003_add_reserved_usernames.sql`
- ุงูุณุฎ ูููุฐ ุงูู SQL

**ูุฐุง ุณูููู ุจู:**
- โ ุฅูุดุงุก ุฌุฏูู `reserved_usernames`
- โ ุฅุถุงูุฉ 20 ุงุณู ูุญุฌูุฒ ุดุงุฆุน (admin, root, ุฅูุฎ)
- โ ุชูุนูู ุงูููุฒุฉ ุจุงููุงูู

---

## ๐ ูุงุฐุง ุชุบููุฑ

### ูุจู (ูุนุทูู):
```
ูุณุชุฎุฏู ูุญุงูู ุงูุชุณุฌูู
  โ
ุงูููุฏ ููุญุต ุฌุฏูู reserved_usernames
  โ
โ ุงูุฌุฏูู ุบูุฑ ููุฌูุฏ โ ุฎุทุฃ
  โ
โ ูุดู ุงูุชุณุฌูู
```

### ุจุนุฏ (ูุตููุญ):
```
ูุณุชุฎุฏู ูุญุงูู ุงูุชุณุฌูู
  โ
ุงูููุฏ ููุญุต ุฌุฏูู reserved_usernames
  โ
โ ุงูุฌุฏูู ุบูุฑ ููุฌูุฏ โ ุชุฌุงูุฒ ุงููุญุต
  โ
โ ูุฌุญ ุงูุชุณุฌูู
```

### ูุน ุงูุฌุฏูู ุงูุงุฎุชูุงุฑู:
```
ูุณุชุฎุฏู ูุญุงูู ุงูุชุณุฌูู
  โ
ุงูููุฏ ููุญุต ุฌุฏูู reserved_usernames
  โ
โ ุงูุฌุฏูู ููุฌูุฏ โ ูุญุต ุฅุฐุง ูุงู ุงูุงุณู ูุญุฌูุฒุงู
  โ
ุฅุฐุง ูุญุฌูุฒ: โ ุฑูุถ ุงูุชุณุฌูู
ุฅุฐุง ุบูุฑ ูุญุฌูุฒ: โ ุงุณุชูุฑุงุฑ ุงูุชุณุฌูู
```

---

## ๐ฏ ููุฎุต ุงูุฅุตูุงุญ ุงูุณุฑูุน

### **ุชู ุงูุฅุตูุงุญ ูู ุงูููุฏ** โ
- ุงูุชุณุฌูู ูุนูู ุงูุขู ุญุชู ุจุฏูู ุงูุฌุฏูู
- ุงูุฎุทุฃ ูููุชูุท ูููุณุฌูู (ูู ุงูุชุทููุฑ ููุท)
- ุงููุณุชุฎุฏููู ูููููู ุงูุชุณุฌูู ุจุดูู ุทุจูุนู

### **ุชุญุณูู ุงุฎุชูุงุฑู** โณ
- ูููุฐ `migrations/003_add_reserved_usernames.sql`
- ูุถูู ุญูุงูุฉ ุถุฏ ุงูุฃุณูุงุก ุงููุญุฌูุฒุฉ
- ูููุน ุงููุณุชุฎุฏููู ูู ุฃุฎุฐ ุฃุณูุงุก ูุซู "admin", "support", ุฅูุฎ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุฑ ุงูุชุณุฌูู (ูุฌุจ ุฃู ูุนูู ุงูุขู):

```bash
curl -X POST https://back-g6gc.onrender.com/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "name": "Test User",
    "email": "test@example.com",
    "password": "password123",
    "phone": "+1234567890"
  }'
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
```json
{
  "status": "success",
  "message": "Registration successful",
  "data": {
    "user": {
      "id": 1,
      "username": "testuser",
      "email": "test@example.com"
    },
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

โ **ุงูุชุณุฌูู ูุฌุจ ุฃู ูุนูู!**

---

## ๐ ุงูุฃุณูุงุก ุงููุญุฌูุฒุฉ (ุฅุฐุง ุฃูุถูู ุงูุฌุฏูู)

ุฅุฐุง ุฃุถูุช ุงูุฌุฏูู ุงูุงุฎุชูุงุฑูุ ูุฐู ุงูุฃุณูุงุก ุณุชูุญุธุฑ:

- admin, administrator, root, system
- support, help, info, contact
- nxoland (ุงุณู ุงูููุตุฉ)
- api, www, mail, email
- webmaster, postmaster, hostmaster
- moderator, mod, staff, official

ุงููุณุชุฎุฏููู ุงูุฐูู ูุญุงูููู ุงูุชุณุฌูู ุจูุง ุณูุญุตููู ุนูู:
```json
{
  "status": "error",
  "message": "Username is reserved and cannot be used"
}
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. โ **ุฅุตูุงุญ ุงูููุฏ ุฌุงูุฒ** - commit ู push
2. โณ **ุงุฎุชูุงุฑู**: ุฃุถู ุฌุฏูู reserved_usernames
3. โณ **ุงุฎุชุจุฑ**: ุฌุฑูุจ ุงูุชุณุฌูู ุจุนุฏ ุงููุดุฑ
4. โ **ุชู!**

---

## ๐ ุงููุชูุฌุฉ

**ุจุนุฏ ุงููุดุฑ:**
- โ API ุงูุชุณุฌูู ูุนูู
- โ ูุง ูุฒูุฏ ูู ุฃุฎุทุงุก "table does not exist"
- โ ุงููุณุชุฎุฏููู ูููููู ุฅูุดุงุก ุญุณุงุจุงุช
- โ ุญูุงูุฉ ุงุฎุชูุงุฑูุฉ ุถุฏ ุงูุฃุณูุงุก ุงููุญุฌูุฒุฉ

**ุงูุชุณุฌูู ุงูุขู ูุนูู ุจุดูู ูุงูู! ๐**

---

## ๐ ุงููููุงุช ุฐุงุช ุงูุตูุฉ

- `src/auth/auth.service.ts` - ุงูููุฏ ุงููุตููุญ
- `migrations/003_add_reserved_usernames.sql` - ุฌุฏูู ุงุฎุชูุงุฑู
- `RESERVED_USERNAMES_FIX.md` - ุงูุฏููู ุจุงูุฅูุฌููุฒูุฉ

---

## โก ุฃูุฑ ูุงุญุฏ ูุฅุถุงูุฉ ุงูุฌุฏูู ุงูุงุฎุชูุงุฑู

```bash
# ุนูู VPS
cd /home/ploi/api.nxoland.com
psql $DATABASE_URL < migrations/003_add_reserved_usernames.sql
```

**ุฃู ูุจุงุดุฑุฉ ูู pgAdmin/phpMyAdmin:**
```sql
-- ุงูุณุฎ ูุงูุตู ูู migrations/003_add_reserved_usernames.sql
```

โ **ุฎูุงุต! ุงูุชุณุฌูู ูุนูู 100%!**
