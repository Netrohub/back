# ğŸ”‘ ÙƒÙŠÙÙŠØ© Ø¬Ø¹Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù†

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

ÙÙŠ v2.0ØŒ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± (Roles) ØªÙØ¯Ø§Ø± Ù…Ù† Ø®Ù„Ø§Ù„ Ø¹Ù„Ø§Ù‚Ø© **many-to-many**:
- Ø¬Ø¯ÙˆÙ„ `users` (Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†)
- Ø¬Ø¯ÙˆÙ„ `roles` (Ø§Ù„Ø£Ø¯ÙˆØ§Ø±)
- Ø¬Ø¯ÙˆÙ„ `user_roles` (Ø±Ø¨Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ø§Ù„Ø£Ø¯ÙˆØ§Ø±)

---

## âš¡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©: SQL Ù…Ø¨Ø§Ø´Ø±

### Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø¨Ø­Ø« Ø¹Ù† ID Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
```sql
-- Ø¨Ø­Ø« Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
SELECT id, username, email FROM users WHERE email = 'user@example.com';

-- Ø£Ùˆ Ø¨Ø­Ø« Ø¨Ø§Ù„ÙŠÙˆØ²Ø±Ù†ÙŠÙ…
SELECT id, username, email FROM users WHERE username = 'johndoe';
```

### Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø£Ø¶Ù Ø¯ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…

```sql
-- Ø§Ø³ØªØ¨Ø¯Ù„ USER_ID Ø¨Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø¸Ù‡Ø± Ù…Ù† Ø§Ù„Ø®Ø·ÙˆØ© 1
INSERT INTO user_roles (user_id, role_id, granted_at)
VALUES (
    USER_ID,  -- Ø¶Ø¹ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§
    (SELECT id FROM roles WHERE slug = 'admin'),
    NOW()
)
ON CONFLICT (user_id, role_id) DO NOTHING;
```

---

## ğŸ¯ Ø£Ù…Ø«Ù„Ø© Ø¬Ø§Ù‡Ø²Ø©

### Ù…Ø«Ø§Ù„ 1: Ø¬Ø¹Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù† Ø¨Ø±Ù‚Ù…Ù‡ (ID)
```sql
-- Ù„Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±Ù‚Ù…Ù‡ 1
INSERT INTO user_roles (user_id, role_id, granted_at)
VALUES (
    1,
    (SELECT id FROM roles WHERE slug = 'admin'),
    NOW()
)
ON CONFLICT DO NOTHING;
```

### Ù…Ø«Ø§Ù„ 2: Ø¬Ø¹Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù† Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
```sql
-- Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„ÙØ¹Ù„ÙŠ
INSERT INTO user_roles (user_id, role_id, granted_at)
SELECT u.id, r.id, NOW()
FROM users u, roles r
WHERE u.email = 'test@test.com' AND r.slug = 'admin'
ON CONFLICT DO NOTHING;
```

### Ù…Ø«Ø§Ù„ 3: Ø¬Ø¹Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù† Ø¨Ø§Ù„ÙŠÙˆØ²Ø±Ù†ÙŠÙ…
```sql
INSERT INTO user_roles (user_id, role_id, granted_at)
SELECT u.id, r.id, NOW()
FROM users u, roles r
WHERE u.username = 'johndoe' AND r.slug = 'admin'
ON CONFLICT DO NOTHING;
```

---

## ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©

### Ø§Ø¹Ø±Ø¶ Ø£Ø¯ÙˆØ§Ø± Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¹ÙŠÙ†
```sql
SELECT 
    u.id,
    u.username,
    u.email,
    r.slug as Ø§Ù„Ø¯ÙˆØ±,
    r.name as Ø§Ø³Ù…_Ø§Ù„Ø¯ÙˆØ±,
    ur.granted_at as ØªØ§Ø±ÙŠØ®_Ø§Ù„Ù…Ù†Ø­
FROM users u
JOIN user_roles ur ON u.id = ur.user_id
JOIN roles r ON ur.role_id = r.id
WHERE u.email = 'test@test.com';
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:**
```
id | username | email          | Ø§Ù„Ø¯ÙˆØ± | Ø§Ø³Ù…_Ø§Ù„Ø¯ÙˆØ± | ØªØ§Ø±ÙŠØ®_Ø§Ù„Ù…Ù†Ø­
---+----------+----------------+-------+-----------+-------------
 1 | johndoe  | test@test.com  | admin | Admin     | 2025-10-28
 1 | johndoe  | test@test.com  | user  | User      | 2025-10-20
```

### Ø§Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯Ù…Ù†Ø²
```sql
SELECT 
    u.id,
    u.username,
    u.email,
    u.created_at
FROM users u
JOIN user_roles ur ON u.id = ur.user_id
JOIN roles r ON ur.role_id = r.id
WHERE r.slug = 'admin'
ORDER BY u.created_at DESC;
```

---

## ğŸ“‹ Ø®Ø·ÙˆØ§Øª Ù…ÙØµÙ„Ø© Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†

### 1ï¸âƒ£ Ø§ÙØªØ­ phpMyAdmin Ø£Ùˆ PostgreSQL Client

**ÙÙŠ Hostinger:**
- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… â†’ Databases â†’ phpMyAdmin

**ÙÙŠ Render:**
- Dashboard â†’ Your PostgreSQL Service â†’ Connect

### 2ï¸âƒ£ Ø§ÙØªØ­ ØªØ¨ÙˆÙŠØ¨ SQL

### 3ï¸âƒ£ Ù†ÙØ° Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…)
```sql
SELECT id, username, email FROM users WHERE email = 'test@test.com';
```

**Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
```
id | username | email
---+----------+----------------
 5 | johndoe  | test@test.com
```

**Ø§Ø­ÙØ¸ Ø§Ù„Ù€ ID** (ÙÙŠ Ø§Ù„Ù…Ø«Ø§Ù„: 5)

### 4ï¸âƒ£ Ù†ÙØ° Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù…Ù†Ø­ Ø§Ù„Ø£Ø¯Ù…Ù†

**Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 1 (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ID):**
```sql
INSERT INTO user_roles (user_id, role_id, granted_at)
VALUES (
    5,  -- Ø¶Ø¹ Ø§Ù„Ù€ ID Ø§Ù„Ù„ÙŠ Ø·Ù„Ø¹ Ù…Ø¹Ùƒ
    (SELECT id FROM roles WHERE slug = 'admin'),
    NOW()
)
ON CONFLICT DO NOTHING;
```

**Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© 2 (Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„):**
```sql
INSERT INTO user_roles (user_id, role_id, granted_at)
SELECT u.id, r.id, NOW()
FROM users u, roles r
WHERE u.email = 'test@test.com' AND r.slug = 'admin'
ON CONFLICT DO NOTHING;
```

### 5ï¸âƒ£ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ø¬Ø§Ø­
```sql
SELECT 
    u.username,
    u.email,
    STRING_AGG(r.slug, ', ') as Ø§Ù„Ø£Ø¯ÙˆØ§Ø±
FROM users u
JOIN user_roles ur ON u.id = ur.user_id
JOIN roles r ON ur.role_id = r.id
WHERE u.email = 'test@test.com'
GROUP BY u.id, u.username, u.email;
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:**
```
username | email          | Ø§Ù„Ø£Ø¯ÙˆØ§Ø±
---------+----------------+--------------
johndoe  | test@test.com  | user, admin
```

âœ… **Ù†Ø¬Ø­Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©!**

---

## ğŸ¯ Ø£ÙˆØ§Ù…Ø± Ø³Ø±ÙŠØ¹Ø© (Ù†Ø³Ø® ÙˆÙ„ØµÙ‚)

### Ø£Ù…Ø± ÙˆØ§Ø­Ø¯: Ø¬Ø¹Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù† Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
```sql
INSERT INTO user_roles (user_id, role_id, granted_at) SELECT u.id, r.id, NOW() FROM users u, roles r WHERE u.email = 'Ø§Ù„Ø¨Ø±ÙŠØ¯_Ù‡Ù†Ø§@example.com' AND r.slug = 'admin' ON CONFLICT DO NOTHING;
```

**Ø§Ø³ØªØ®Ø¯Ø§Ù…:**
1. Ø§Ù†Ø³Ø® Ø§Ù„Ø£Ù…Ø± Ø£Ø¹Ù„Ø§Ù‡
2. Ø§Ø³ØªØ¨Ø¯Ù„ `Ø§Ù„Ø¨Ø±ÙŠØ¯_Ù‡Ù†Ø§@example.com` Ø¨Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„ÙØ¹Ù„ÙŠ
3. Ù†ÙØ° ÙÙŠ SQL

### Ø£Ù…Ø± ÙˆØ§Ø­Ø¯: Ø¬Ø¹Ù„ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù† Ø¨Ø§Ù„ÙŠÙˆØ²Ø±Ù†ÙŠÙ…
```sql
INSERT INTO user_roles (user_id, role_id, granted_at) SELECT u.id, r.id, NOW() FROM users u, roles r WHERE u.username = 'Ø§Ù„ÙŠÙˆØ²Ø±Ù†ÙŠÙ…_Ù‡Ù†Ø§' AND r.slug = 'admin' ON CONFLICT DO NOTHING;
```

---

## âŒ Ø¥Ø²Ø§Ù„Ø© Ø¯ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù†

Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø¥Ø²Ø§Ù„Ø© ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ø£Ø¯Ù…Ù† Ù…Ù† Ù…Ø³ØªØ®Ø¯Ù…:

```sql
-- Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
DELETE FROM user_roles
WHERE user_id = (SELECT id FROM users WHERE email = 'test@test.com')
AND role_id = (SELECT id FROM roles WHERE slug = 'admin');
```

```sql
-- Ø¨Ø§Ù„Ù€ ID
DELETE FROM user_roles
WHERE user_id = 5
AND role_id = (SELECT id FROM roles WHERE slug = 'admin');
```

---

## ğŸ“š Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©

Ù„Ù…Ø¹Ø±ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©:

```sql
SELECT id, slug, name, description FROM roles ORDER BY slug;
```

**Ø§Ù„Ø£Ø¯ÙˆØ§Ø± Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©:**
- `admin` - ØµÙ„Ø§Ø­ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©
- `user` - Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø§Ø¯ÙŠ
- `seller` - Ø¨Ø§Ø¦Ø¹ (ÙŠÙ…ÙƒÙ†Ù‡ Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§Øª)
- `moderator` - Ù…Ø´Ø±Ù (Ø¥Ù† ÙˆÙØ¬Ø¯)

---

## âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

### 1. Ø£Ø¯ÙˆØ§Ø± Ù…ØªØ¹Ø¯Ø¯Ø©
- Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ù„Ù‡ Ø£ÙƒØ«Ø± Ù…Ù† Ø¯ÙˆØ±
- Ù…Ø«Ø§Ù„: Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙƒÙˆÙ† `user` Ùˆ `seller` Ùˆ `admin` ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª

### 2. Ø§Ù„Ø£Ù…Ø§Ù†
- Ø¬Ù…Ù„Ø© `ON CONFLICT DO NOTHING` ØªÙ…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
- Ø¢Ù…Ù† Ù„ØªÙ†ÙÙŠØ°Ù‡ Ø¹Ø¯Ø© Ù…Ø±Ø§Øª

### 3. Ø£Ø¯ÙˆØ§Ø± Ù…Ø¤Ù‚ØªØ©
ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ù†Ø­ Ø£Ø¯Ù…Ù† Ù„ÙØªØ±Ø© Ù…Ø­Ø¯Ø¯Ø©:

```sql
INSERT INTO user_roles (user_id, role_id, granted_at, expires_at)
VALUES (
    5,
    (SELECT id FROM roles WHERE slug = 'admin'),
    NOW(),
    NOW() + INTERVAL '7 days'  -- ØªÙ†ØªÙ‡ÙŠ Ø¨Ø¹Ø¯ 7 Ø£ÙŠØ§Ù…
);
```

### 4. Ø§Ù„ØªØ­Ù‚Ù‚ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
```sql
-- ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ù…Ù† Ø¨Ø§Ù„ÙØ¹Ù„
SELECT EXISTS (
    SELECT 1 FROM user_roles ur
    JOIN roles r ON ur.role_id = r.id
    WHERE ur.user_id = 5 AND r.slug = 'admin'
) as Ù‡Ù„_Ø£Ø¯Ù…Ù†;
```

---

## ğŸš€ Ø¯Ù„ÙŠÙ„ Ø³Ø±ÙŠØ¹ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©

### Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£Ø³Ø±Ø¹ (Ø£Ù…Ø± ÙˆØ§Ø­Ø¯):

1. **Ø§ÙØªØ­ phpMyAdmin Ø£Ùˆ PostgreSQL Client**

2. **Ù†ÙØ° Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø±** (ØºÙŠÙ‘Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„):
```sql
INSERT INTO user_roles (user_id, role_id, granted_at)
SELECT u.id, r.id, NOW()
FROM users u, roles r
WHERE u.email = 'test@test.com' AND r.slug = 'admin'
ON CONFLICT DO NOTHING;
```

3. **ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ø¬Ø§Ø­:**
```sql
SELECT u.username, u.email, STRING_AGG(r.slug, ', ') as roles
FROM users u
JOIN user_roles ur ON u.id = ur.user_id
JOIN roles r ON ur.role_id = r.id
WHERE u.email = 'test@test.com'
GROUP BY u.id, u.username, u.email;
```

âœ… **Ø®Ù„Ø§Øµ! Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØµØ§Ø± Ø£Ø¯Ù…Ù†**

---

## ğŸ‰ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©

Ø¨Ø¹Ø¯ ØªÙ†ÙÙŠØ° Ø§Ù„Ø£ÙˆØ§Ù…Ø±ØŒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø³ÙŠØµØ¨Ø­ Ø¹Ù†Ø¯Ù‡:
- âœ… ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†
- âœ… ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ø³ØªØ®Ø¯Ø§Ù… Admin APIs (`/api/admin/*`)
- âœ… Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ Ø¥Ù„Ø®
- âœ… Ø³Ø¬Ù„ ÙÙŠ Ø¬Ø¯ÙˆÙ„ `user_roles` ÙŠØ±Ø¨Ø·Ù‡ Ø¨Ø¯ÙˆØ± admin

---

## ğŸ”§ Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: "role not found"
**Ø§Ù„Ø­Ù„:** ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¯ÙˆØ± admin:
```sql
SELECT * FROM roles WHERE slug = 'admin';
```

Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯ØŒ Ø£Ù†Ø´Ø¦Ù‡:
```sql
INSERT INTO roles (name, slug, description, is_active, created_at, updated_at)
VALUES ('Admin', 'admin', 'Full system access', true, NOW(), NOW());
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: "user not found"
**Ø§Ù„Ø­Ù„:** ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:
```sql
SELECT id, username, email FROM users WHERE email LIKE '%test%';
```

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: "duplicate key"
**Ø§Ù„Ù…Ø¹Ù†Ù‰:** Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ø£Ø¯Ù…Ù†! âœ…
```sql
-- ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ø¯ÙˆØ§Ø±Ù‡
SELECT r.slug FROM user_roles ur
JOIN roles r ON ur.role_id = r.id
WHERE ur.user_id = 5;
```

---

## ğŸ“ Ø£Ù…Ø«Ù„Ø© Ø¥Ø¶Ø§ÙÙŠØ©

### Ù…Ù†Ø­ Ø¹Ø¯Ø© Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¯ÙˆØ± Ø£Ø¯Ù…Ù† Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©
```sql
INSERT INTO user_roles (user_id, role_id, granted_at)
SELECT u.id, r.id, NOW()
FROM users u, roles r
WHERE u.email IN ('user1@test.com', 'user2@test.com', 'user3@test.com')
AND r.slug = 'admin'
ON CONFLICT DO NOTHING;
```

### Ù…Ù†Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ sellers Ø¯ÙˆØ± Ø£Ø¯Ù…Ù†
```sql
INSERT INTO user_roles (user_id, role_id, granted_at)
SELECT DISTINCT ur.user_id, r.id, NOW()
FROM user_roles ur
CROSS JOIN roles r
WHERE ur.role_id = (SELECT id FROM roles WHERE slug = 'seller')
AND r.slug = 'admin'
ON CONFLICT DO NOTHING;
```

---

## ğŸ¯ Ø§Ù„Ø®Ù„Ø§ØµØ©

**Ø£Ø³Ø±Ø¹ Ø·Ø±ÙŠÙ‚Ø©:**
```sql
-- ØºÙŠÙ‘Ø± Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙÙ‚Ø· ÙˆØ´ØºÙ‘Ù„
INSERT INTO user_roles (user_id, role_id, granted_at)
SELECT u.id, r.id, NOW() FROM users u, roles r
WHERE u.email = 'Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„_Ù‡Ù†Ø§@example.com' AND r.slug = 'admin'
ON CONFLICT DO NOTHING;
```

**ØªØ­Ù‚Ù‚:**
```sql
-- ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù†Ø¬Ø§Ø­
SELECT u.username, STRING_AGG(r.slug, ', ') as roles
FROM users u
JOIN user_roles ur ON u.id = ur.user_id
JOIN roles r ON ur.role_id = r.id
WHERE u.email = 'Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„_Ù‡Ù†Ø§@example.com'
GROUP BY u.username;
```

âœ… **ØªÙ…! Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØµØ§Ø± Ø£Ø¯Ù…Ù† Ø¨Ù†Ø¬Ø§Ø­!** ğŸ‰
